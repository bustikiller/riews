<% url = filter_criteria.persisted? ? view_filter_path(filter_criteria.view, filter_criteria) : view_filters_path(filter_criteria.view) %>
<%= simple_form_for([filter_criteria.view, filter_criteria], url: url) do |f| %>
    <%= f.input :field_name, as: :select, collection: filter_criteria.available_columns %>
    <%= f.input :operator, as: :select, collection: operators_for_select, value_method: :first, label_method: :last %>
    <%= f.input :negation %>
    <%= content_tag :h3, 'Arguments' %>
    <%= f.fields_for :arguments do |ff| %>
        <%= render 'argument_fields', f: ff %>
    <% end %>
    <%= content_tag :div do %>
        <%= link_to_add_association 'Add argument', f, :arguments %>
    <% end %>

    <%= f.submit %>
<% end %>
